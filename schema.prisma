generator client {
  provider = "prisma-client"
  output   = "./generated"
}

datasource db {
  provider = "postgresql"
}

model Profile {
  id                              String                  @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  full_name                       String?
  email                           String?                 @unique
  avatar_url                      String?
  metadata                        Json?                   @default(dbgenerated("'{}'::jsonb"))
  created_at                      DateTime                @default(now()) @db.Timestamptz(6)
  updated_at                      DateTime                @updatedAt @db.Timestamptz(6)
  auth_id                         String?                 @unique @db.Uuid
  username                        String?                 @unique
  phone                           String?
  locale                          String?
  timezone                        String?
  bio                             String?
  website                         String?
  pronouns                        String?
  profile_social_links            ProfileSocialLinks[]

  @@index([auth_id], map: "idx_profiles_auth_id")
  @@index([username], map: "idx_profiles_username")
  @@index([email], map: "idx_profiles_email")
  @@index([phone], map: "idx_profiles_phone")

  @@map("profiles")
}

model ProfileSocialLinks {
  id         String   @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  profile_id String   @db.Uuid
  kind       String
  url        String
  label      String?
  created_at DateTime @default(now()) @db.Timestamptz(6)
  updated_at DateTime @updatedAt @db.Timestamptz(6)
  profiles   Profile  @relation(fields: [profile_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@unique([profile_id, kind], map: "uq_profile_social_links_profile_kind")
  @@index([profile_id], map: "idx_profile_social_links_profile_id")
  @@map("profile_social_links")
}